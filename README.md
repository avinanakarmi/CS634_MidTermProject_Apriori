# Association Rule Mining with Apriori and FP-Growth

This Jupyter notebook demonstrates the implementation and comparison of association rule mining algorithms, specifically the Apriori and FP-Growth algorithms, using a dataset of transactions.

## Contents

1. **Utility Functions**
   - `do_while(check_condition, action)`: Repeatedly executes an action until a specified condition is met.

2. **Data Selection**
   - **Description**: Allows users to select a dataset from a predefined list and prints the selected dataset.
   - **Function**: `read_dataset_input()`

3. **Defining Support and Confidence**
   - **Description**: Prompts users to input thresholds for support and confidence. Validates the input to ensure it falls within the range [0, 1].
   - **Functions**: 
     - `read_threshold()`
     - `threshold_read_condition()`

4. **Reading Transactions**
   - **Description**: Reads a CSV file containing transaction data, processes it into a list of transactions, and prints the data.

5. **Apriori Algorithm Using `mlxtend` Package**
   - **Description**: Applies the Apriori algorithm to generate frequent itemsets and association rules using the `mlxtend` package.
   - **Steps**:
     - Import necessary libraries.
     - Load transaction data.
     - Generate frequent itemsets and association rules.
     - Print the rules and their metrics.
   
6. **FP-Growth Algorithm Using `mlxtend` Package**
   - **Description**: Applies the FP-Growth algorithm to generate frequent itemsets and association rules using the `mlxtend` package.
   - **Steps**:
     - Import necessary libraries.
     - Load transaction data.
     - Generate frequent itemsets and association rules.
     - Print the rules and their metrics.

7. **Implementing Apriori Algorithm Manually**
   - **Description**: Manually implements the Apriori algorithm to generate frequent itemsets and calculate their support. This implementation also mines association rules based on confidence thresholds.
   - **Functions:**
     - **`count_item_freq(itemsets)`**:
       - Iterates over transactions to check the presence of itemsets and counts their frequency.
       - **Returns**: A dictionary where keys are itemsets and values are their frequencies.
     - **`prune_items(last_freq_itemset)`**:
       - Filters out itemsets with support below the minimum threshold (`min_sup`).
       - **Returns**: A dictionary of itemsets with their relative support (support count divided by total transactions).
     - **`make_n_itemset(n_itemset)`**:
       - Generates (n+1)-itemsets by combining unique items from the provided `n_itemset`.
         - **Returns**: A list of all possible (n+1)-itemsets.
   - **Algorithm Flow**:
     1. **Generating Frequent Itemsets**:
        - The algorithm starts by generating individual itemsets from the transactions.
        - It then iterates to generate higher-level itemsets (n+1) using the functions provided:
          - **`count_item_freq`** counts itemset frequencies.
          - **`prune_items`** filters out infrequent itemsets.
          - **`make_n_itemset`** creates the next level of itemsets.
        - This loop continues until no more frequent itemsets can be generated.
     2. **Mining Association Rules**:
        - The frequent itemsets are used to generate association rules.
        - For each itemset with 2 or more items, it computes the confidence of the rule:
          - **Confidence** is calculated as the ratio of the frequency of the full itemset to the frequency of the antecedent.
          - If the confidence exceeds the specified threshold, the rule is retained.

## Requirements

- `pandas`
- `mlxtend` (for Apriori and FP-Growth algorithms)
- `itertools`

To install the necessary packages, you can use the following commands:

```bash
pip install pandas mlxtend itertools
```

## Usage

1. **Dataset Selection**: The notebook will prompt you to select a dataset from a list. Enter the corresponding number to choose the dataset.

2. **Thresholds Input**: Provide support and confidence thresholds when prompted. The values should be between 0 and 1.

3. **Transaction Processing**: The notebook will read and process the transactions from the selected dataset.

4. **Association Rule Mining**:
   - **Apriori Algorithm**: Generates frequent itemsets and association rules using the `mlxtend` package.
   - **FP-Growth Algorithm**: Similar to Apriori but often more efficient.

5. **Manual Apriori Implementation**: For educational purposes, the notebook also includes a manual implementation of the Apriori algorithm.

## Output

- The notebook outputs the association rules generated by both the Apriori and FP-Growth algorithms, including metrics such as support, and confidence.
- For the manual implementation, it prints the frequent itemsets and their supports.

## Example Output

For example, after running the notebook, you might see results like:

```
Rule  1 :  ('Bed Skirts',) -> ('Kids Bedding',)
Confidence:  90.9090909090909 %
Support:  50.0 %


Rule  2 :  ('Kids Bedding',) -> ('Bed Skirts',)
Confidence:  83.33333333333334 %
Support:  50.0 %


Rule  3 :  ('Kids Bedding',) -> ('Sheets',)
Confidence:  83.33333333333334 %
Support:  50.0 %


Rule  4 :  ('Sheets',) -> ('Kids Bedding',)
Confidence:  100.0 %
Support:  50.0 %


Time taken:  0.004616975784301758  seconds
...
```

## Notes

- Ensure that the dataset CSV files are located in the `./datasets/` directory.
- The notebook is designed to be interactive and will prompt for user inputs.
